# Description:  Port of various original Plan9 tools to *nix - git checkout
# URL:          http://tools.suckless.org/9base
# Packager:     kori, kori at openmailbox dot org
# Maintainer:   kori, kori at openmailbox dot org
# Depends on:   git 

name=9base
version=git
release=1
source=(9 plan9.sh)

build() {
	cd $PKGMK_SOURCE_DIR

	if cd $name; then
		git pull git://git.suckless.org/$name
	else
		git clone git://git.suckless.org/$name $name
		cd $name
	fi

	sed -i 's#^OBJTYPE\s.*$#OBJTYPE = x86_64#' config.mk
	sed -i 's#^PREFIX\s.*$#PREFIX = /opt/plan9#' config.mk
	sed -i 's#^CFLAGS\s*+=#CFLAGS += -DPLAN9PORT #' config.mk
	sed -i '/-static/d' config.mk

	make
	make DESTDIR=$PKG install
	install -Dm755 $SRC/9 $PKG/usr/bin/9
	install -Dm755 $SRC/plan9.sh $PKG/etc/profile.d/plan9.sh

	rm -f $PKG/opt/plan9/lib/troff/font/devutf/charlib/README
}
